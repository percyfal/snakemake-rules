# -*- snakemake -*-
include: 'angsd.settings'
include: 'angsd_dothetas.rule'
include: 'angsd_thetastat_makebed.rule'

config_default = {
    'angsd' : {
        'thetastat_dostat' : {
            'options' : config['angsd']['options'],
            'runtime' : config['angsd']['runtime'],
            },
    },
}

update_config(config_default, config)
config = config_default

rule angsd_thetastat_dostat:
    """angsd thetastat dostat: estimate for every chromosome
    """
    params:
        options = " ".join(['-nChr {}'.format(config['angsd']['nChr']),
                            config['angsd']['thetastat_dostat']['options']]),
        runtime = config['angsd']['thetastat_dostat']['runtime']
    input: bin = "{prefix}.bin", idx = "{prefix}.idx"
    output: thetas = "{prefix}.pestPG"
    threads: 1
    conda: "env.yaml"
    shell: "thetaStat do_stat {wildcards.prefix} {params.options}"
